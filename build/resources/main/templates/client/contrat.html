<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <title>SAHAM Assurance Vie | Contrat</title>
    <meta charset="utf-8">
    <meta content="ie=edge" http-equiv="x-ua-compatible">
    <meta content="template language" name="keywords">
    <meta content="Tamerlan Soziev" name="author">
    <meta content="Admin dashboard html template" name="description">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link href="./img/favico.png" rel="shortcut icon">
    <link href="apple-touch-icon.png" rel="apple-touch-icon">
    <link href="https://fonts.googleapis.com/css?family=Rubik:300,400,500" rel="stylesheet" type="text/css">
    <link href="../bower_components/select2/dist/css/select2.min.css" rel="stylesheet">
    <link href="../bower_components/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet">
    <link href="../bower_components/dropzone/dist/dropzone.css" rel="stylesheet">
    <link href="../bower_components/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet">
    <link href="../bower_components/fullcalendar/dist/fullcalendar.min.css" rel="stylesheet">
    <link href="../bower_components/perfect-scrollbar/css/perfect-scrollbar.min.css" rel="stylesheet">
    <link href="../css/main.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/awesome/css/font-awesome.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.1.5/css/iziToast.min.css" rel="stylesheet">
</head>
<body>
<div th:replace="fragments/fragment-banniere-message :: banniere-message"></div>
<div class="menudrop">
    <div class="menudropdiv">
        <p><a href="">Profil</a></p>
        <!--<a href="">Paramètres</a></p>-->
        <p><a th:href="@{/disconnect}">Deconnexion</a></p>
    </div>
</div>
<div class="all-wrapper menu-top">
    <div class="layout-w">
        <!--------------------
        START - Mobile Menu
        -------------------->
        <div class="menu-mobile menu-activated-on-click color-scheme-dark">
            <div class="mm-logo-buttons-w">

            </div>
            <div class="menu-and-user">

                <!--------------------
                START - Mobile Menu List
                -------------------->
                <!--------------------
                END - Mobile Menu List
                -------------------->

            </div>
        </div>
        <!--------------------
        END - Mobile Menu
        -------------------->

        <!--------------------
        START - Menu top image 
        -------------------->
        <div th:replace="fragments/fragment-menu-top-image-w :: menu-top-image-w"></div>

        <div class="content-w">
            <!--------------------
            START - Breadcrumbs
            -------------------->

            <!--------------------
            END - Breadcrumbs
            -------------------->
            <div class="content-i">
                <div class="content-box">
                    <div class="row">
                        <div class="col-sm-4 col-xl-4">
                            <div class="element-wrapper" th:if="${isEnterprise == false}">
                                <h6 class="element-header">
                                    Autres contrats
                                </h6>
                                <div style="margin-top:17px; display:block; float:left; width:100%" class="element-box">
                                    <div class="DivContent" style="margin-top:17px; ">
                                        <div class="BlockContent">
                                            <table width="100%" border="0">
                                                <tbody>
                                                <tr>
                                                    <td>Police</td>
                                                    <td>Date d'effet</td>
                                                    <td>&nbsp;</td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="divcl">


                                            <div class="blockDivcl" th:each="cont: ${contrats}">
                                                <table width="100%" border="0">
                                                    <tbody>
                                                    <tr>
                                                        <td th:text="${cont?.police}">00000000</td>
                                                        <td th:text="${cont?.dateEffet} ? ${#dates.format(cont.dateEffet,'dd/MM/yyyy')}">
                                                            99/99/2017
                                                        </td>
                                                        <td><a href="#" class="BtnCtrt" th:id="${cont.getId()}"><i
                                                                class="fa fa-angle-down" aria-hidden="true"></i></a>
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                                <p class="sectionD" th:id="'blockCtrt'+${cont.getId()}">
                                                    <a class="BtnActivC" href="javascript:gotoPage(1)"><i
                                                            class="fa fa-caret-right" aria-hidden="true"></i> Relevé de
                                                        cotisation</a>
                                                    <a class="BtnActivC" href="javascript:gotoPage(2)"><i
                                                            class="fa fa-caret-right" aria-hidden="true"></i> Situation
                                                        de compte actuelle</a>
                                                    <a class="BtnActivC" href="javascript:gotoPage(4)"><i
                                                            class="fa fa-caret-right" aria-hidden="true"></i> Situation
                                                        de compte annuelle</a>
                                                    <a class="BtnActivC" href="javascript:gotoPage(3)"><i
                                                            class="fa fa-caret-right" aria-hidden="true"></i>
                                                        Prestations</a>
                                                </p>
                                            </div>
                                        </div>
                                        <!-- <div id="btnGo">
                                           <a id="prev" href="#"><i class="fa fa-chevron-left" aria-hidden="true"></i></a>
                                           <a id="next" href="#"><i class="fa fa-chevron-right" aria-hidden="true"></i></a>
                                         </div>-->
                                    </div>
                                </div>
                            </div>
                            <div class="element-wrapper" th:if="${isEnterprise}">
                                <h6 class="element-header autre-produits">
                                    Autres produits
                                </h6>
                                <div style="margin-top:17px; display:block; float:left; width:100%" class="element-box">
                                    <div class="DivContent" style="margin-top:17px; ">
                                        <div class="BlockContent">

                                        </div>
                                        <div class="divcl">
                                            <div class="blockDivcl" th:each="product: ${products}">
                                                <table width="100%" border="0">
                                                    <tbody>
                                                    <tr>
                                                        <td th:text="${product?.nomProduit}">00000000</td>
                                                        <td align="right">
                                                            <a href="#" class="BtnCtrt" th:id="${product.getId()}">
                                                               <i class="fa fa-angle-down" aria-hidden="true"></i>
                                                            </a>
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                                <p class="sectionD" th:id="'blockCtrt'+${product.getId()}">
                                                    <a class="BtnActivC" href="javascript:gotoPage(6)"><i
                                                            class="fa fa-caret-right" aria-hidden="true"></i> Situation
                                                        de compte globale</a>
                                                    <a class="BtnActivC" href="javascript:gotoPage(5)"><i
                                                            class="fa fa-caret-right" aria-hidden="true"></i> Compte de
                                                        resultat</a>
                                                </p>
                                            </div>
                                        </div>


                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-8 col-xl-8" id="contenu">
                            <div class="element-wrapper" th:if="${isEnterprise}">
                               <h4 class="element-header sit-compte-globale">
                                 <b>Situation de compte globale Retraite complémentaire</b>
                               </h4>
                               <div style="margin-top:17px;" class="element-box">
                                 <div class="w90">
                                   <div class="titreSimuLeft" th:text="${sitgble?.dateSituation} ? 'Année '+${#dates.format(sitgble?.dateSituation,'yyyy')}">
                                     Année 2018
                                   </div>
                                   <div class="titreSimuRight">
                                     <a href="javascript:generatePdf()" title="Exporter en PDF"><i class="fa fa-file-pdf-o" aria-hidden="true"></i></a>
                                   </div>
                                 </div>
                                 <div class="FormSit2" id="monPdf">
                                   <div class="w95">
                                     <p class="logoPdf" style="display: none"><img src="../img/logo_saham-vie.png" /></p>

                                     <div class="titreSimu">
                                       <table border="0" cellspacing="0" cellpadding="0">
                                         <tr>
                                           <td valign="top"><p><strong>Numéro de contrat</strong></p></td>
                                           <td valign="top"><p><strong th:text="${perso?.matricule}">-</strong></p></td>
                                         </tr>
                                         <tr>
                                           <td valign="top"><p><strong>Souscripteur</strong></p></td>
                                           <td valign="top"><p><strong th:text="${sitgble?.contractant}">ORANGE COTE D'IVOIRE </strong></p></td>
                                         </tr>
                                         <tr>
                                           <td valign="top"><p><strong>Date d'inventaire</strong></p></td>
                                           <td valign="top"><p><strong th:text="${sitgble?.dateSituation} ? ${#dates.format(sitgble?.dateSituation,'dd/MM/yyyy')}">31/10/2017 </strong></p></td>
                                         </tr>
                                       </table>

                                     </div>
                                     <p>&nbsp;</p>
                                     <table border="1" cellspacing="0" cellpadding="0" class="Tablecenter">
                                       <tr>
                                         <td th:objet="${anneeAnterieur}"><p align="center"><strong>Provisions Mathématiques au </strong><br><strong>1er janv <span th:text="${sitgble?.dateSituation} ? ${#dates.year(sitgble?.dateSituation)}">31/12/2016</span></strong></p></td>
                                         <td valign="center"><p align="center"><strong>Cotisations perçues</strong></p></td>
                                         <td align="center"><p align="center"><strong>Prime nette</strong></p></td>
                                         <td align="center"><p><strong>Intérêts</strong></p></td>
                                         <td align="center"><p><strong>Prestations</strong></p></td>
                                         <td align="center"><p><strong>Provisions Mathématiques au </strong><strong th:text="${sitgble?.dateSituation} ? ${#dates.format(sitgble?.dateSituation,'dd/MM/yyyy')}">31/10/2017</strong></p></td>
                                       </tr>
                                       <tr>
                                         <td valign="center" th:text="${sitgble?.capitalAcquisJanv} ? ${#numbers.formatInteger(sitgble?.capitalAcquisJanv,3,'WHITESPACE')}+' FCFA':'0 FCFA'">5 938 465 892 FCFA</td>
                                         <td valign="center" th:text="${sitgble?.cotisationAnnuelle} ? ${#numbers.formatInteger(sitgble?.cotisationAnnuelle,3,'WHITESPACE')}+' FCFA':'0 FCFA'">539 195 100 FCFA</td>
                                         <td valign="center" th:text="${sitgble?.primeNette} ? ${#numbers.formatInteger(sitgble?.primeNette,3,'WHITESPACE')}+' FCFA':'0 FCFA'">534 635 389 FCFA</td>
                                         <td valign="center" th:text="${sitgble?.interet} ? ${#numbers.formatInteger(sitgble?.interet,3,'WHITESPACE')}+' FCFA':'0 FCFA'">213 925 439 FCFA</td>
                                         <td valign="center" th:text="${sitgble?.prestation} ? ${#numbers.formatInteger(sitgble?.prestation,3,'WHITESPACE')}+' FCFA':'0 FCFA'">1 181 747 404 FCFA</td>
                                         <td valign="center" th:text="${sitgble?.capitalAu} ? ${#numbers.formatInteger(sitgble?.capitalAu,3,'WHITESPACE')}+' FCFA':'0 FCFA'">6 636 026 316 FCFA</td>
                                       </tr>
                                     </table>
                                   </div>

                                   <br>
                                   <p class="logoPdf" style="display: none" align="right" th:text="'Téléchargé le '+${#dates.format(#dates.createNow(), 'dd MMM yyyy')}">Téléchargé le </p>
                                 </div>
                               </div>
                             </div>
                             <div class="element-wrapper" th:if="${isEnterprise == false}">

                               <p> <h4 class="element-header">
                               <b th:text="'Relevé de cotisations ['+${contrat?.police} +'-'+ ${contrat?.produit?.nomProduit}+']'">Relevé de cotisations [75364892]</b>

                             </h4></p><br>
                               <table width="100%" border="0" style="font-size:16px">
                                 <tbody>
                                 <tr>
                                   <td><i class="fa fa-line-chart" aria-hidden="true"></i> Cumul des primes payées : <b th:text="${cumul_paye} ? ${#numbers.formatInteger(cumul_paye,3,'WHITESPACE')}+' FCFA':'0 FCFA'">500.000 FCFA</b></td>
                                   <td><i class="fa fa-pie-chart" aria-hidden="true"></i> Cumul des primes impayées : <b th:text="${cumul_impaye} ? ${#numbers.formatInteger(cumul_impaye,3,'WHITESPACE')}+' FCFA': '0 FCFA'">300.000 FCFA</b></td>
                                 </tr>
                                 </tbody>
                               </table>
                               <div style="margin-top:17px;" class="element-box">
                                 <div class="table-responsive">
                                   <table id="dataTable1" width="100%" class="table table-striped table-lightfont">
                                     <thead>
                                     <tr>
                                       <th class="text-center">Mouvement </th>
                                       <th class="text-center">Produit</th>
                                       <th class="text-center">Echéance </th>
                                       <th class="text-center">Montant </th>
                                       <th class="text-center">Payé </th>
                                       <th class="text-center">STATUT</th>
                                     </tr>
                                     </thead>

                                     <tbody>
                                     <tr th:each="qtce: ${quitanceReleve}">
                                       <td class="text-center" th:text="${qtce?.objet?.nomObjet}">Prime</td>
                                       <td class="text-center" th:text="${qtce?.contrat?.produit?.nomProduit}">Produit</td>
                                       <td class="text-center" th:text="${qtce.echeance} ? ${#dates.format(qtce.echeance, 'dd/MM/yyyy')}">01/01/2017</td>
                                       <td class="text-center" th:text="${qtce.montantEmis} ? ${#numbers.formatInteger(qtce.montantEmis,3,'WHITESPACE')}+' FCFA':'0 FCFA'">50.000 FCFA</td>
                                       <td class="text-center" th:text="${qtce.montantPaye} ? ${#numbers.formatInteger(qtce.montantPaye,3,'WHITESPACE')}+' FCFA':'0 FCFA'">50.000 FCFA</td>
                                       <td class="text-center">
                                         <div th:if="${qtce?.statutQuitance?.statutQuit=='payé'}" class="status-pill green" data-title="payé" data-toggle="tooltip" data-original-title="" title=""></div>
                                         <div th:if="${qtce?.statutQuitance?.statutQuit=='impayé'}" class="status-pill red" data-title="impayé" data-toggle="tooltip" data-original-title="" title=""></div>
                                       </td>
                                     </tr>
                                     </tbody>
                                   </table>
                                 </div>
                               </div>
                             </div>
                        </div>
                    </div>


                    <!-- Modal HTML -->
                    <div id="valeurRachatModal" class="modal fade">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-body">
                                    <div class="BtnCloseDiv">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                            &times;
                                        </button>
                                    </div>
                                    <div class="DivModalContent">
                                        <p>
                                        <h3><b>Valeur de rachat</b></h3></p>
                                        <p>La valeur de rachat est le montant reversé lorsqu'il est mis fin au contrat
                                            après le paiement effectif des primes pendant deux (2)
                                            années au moins ou lorsque 15% des primes prévues au contrat ont été
                                            versées.</p>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <div id="valeurReduction" class="modal fade">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-body">
                                    <div class="BtnCloseDiv">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                            &times;
                                        </button>
                                    </div>
                                    <div class="DivModalContent">
                                        <p>
                                        <h3><b>Valeur de réduction</b></h3></p>
                                        <p>La réduction est l'opération qui consiste à suspendre le paiement des primes
                                            prévues au contrat sans effectuer de rachat.
                                            les garanties continuent de courir jusqu'à leur terme mais pour un montant
                                            réduit appelé valeur de réduction.</p>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <div id="provisionMathematique" class="modal fade">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-body">
                                    <div class="BtnCloseDiv">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                            &times;
                                        </button>
                                    </div>
                                    <div class="DivModalContent">
                                        <p>
                                        <h3><b>Provision mathématique </b></h3></p>
                                        <p>
                                            Le capital de base est la valeur de l'épargne acquise du contrat. Il est
                                            constitué progressivement par les versements successifs
                                            diminués des chargements et est capitalisé au taux d’intérêt technique
                                            garanti annuel de . Le capital de base est revalorisé des participations
                                            aux bénéfices et réduit des éventuels montants de rachats partiels et
                                            pénalités y afférentes.
                                        </p>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <!--------------------
                    START - Chat Popup Box
                    -------------------->

                    <!--------------------
                    END - Chat Popup Box
                    -------------------->
                </div>
            </div>
        </div>
    </div>
    <div class="display-type"></div>
</div>
<script src="../bower_components/jquery/dist/jquery.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../bower_components/moment/moment.js"></script>
<script src="../bower_components/chart.js/dist/Chart.min.js"></script>
<script src="../bower_components/select2/dist/js/select2.full.min.js"></script>
<script src="../bower_components/ckeditor/ckeditor.js"></script>
<script src="../bower_components/bootstrap-validator/dist/validator.min.js"></script>
<script src="../bower_components/bootstrap-daterangepicker/daterangepicker.js"></script>
<script src="../bower_components/dropzone/dist/dropzone.js"></script>
<script src="../bower_components/editable-table/mindmup-editabletable.js"></script>
<script src="../bower_components/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="../bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
<script src="../bower_components/fullcalendar/dist/fullcalendar.min.js"></script>
<script src="../bower_components/perfect-scrollbar/js/perfect-scrollbar.jquery.min.js"></script>
<script src="../bower_components/tether/dist/js/tether.min.js"></script>
<script src="../bower_components/bootstrap/js/dist/util.js"></script>
<script src="../bower_components/bootstrap/js/dist/alert.js"></script>
<script src="../bower_components/bootstrap/js/dist/button.js"></script>
<script src="../bower_components/bootstrap/js/dist/carousel.js"></script>
<script src="../bower_components/bootstrap/js/dist/collapse.js"></script>
<script src="../bower_components/bootstrap/js/dist/dropdown.js"></script>
<!--    <script src="../bower_components/bootstrap/js/dist/modal.js"></script>-->
<script src="../bower_components/bootstrap/js/dist/tab.js"></script>
<script src="../bower_components/bootstrap/js/dist/tooltip.js"></script>
<script src="../bower_components/bootstrap/js/dist/popover.js"></script>
<script src="../js/dataTables.bootstrap4.min.js"></script>
<!--    <script src="../js/main.js"></script>-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.1.5/js/iziToast.min.js"></script>
<script src="../js/main.js"></script>
<script src="../js/popup.js"></script>
<script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.debug.js"></script>

<script>
    // données globales

    console.log("oki");
    var content;
    var doc;
    var idContrat;

    $('.BtnActivC').click(function () {
        $('.sectionD a').removeClass("activContrat");
        $(this).addClass("activContrat");
    });

    function gotoPage(num) {
        $.ajax({
            url: '/ajax-07',
            type: 'POST',
            data: 'num=' + num + '&' + 'id=' + idContrat,
            dataType: 'html',
            beforeSend: function () {
                content.html("<div class=\"element-wrapper\">\n" +
                    "    <h4 class=\"element-header\">\n" +
                    "        <b>Chargement des données</b>\n" +
                    "    </h4>\n" +
                    "    <div style=\"margin-top:17px;\" class=\"element-box\">\n" +
                    "        <div class=\"FormSit2\">\n" +
                    "            <div class=\"w95\">\n" +
                    "                <div id=\"preloader\">\n" +
                    "                    <div id=\"loader\"></div>\n" +
                    "                </div>\n" +
                    "            </div>\n" +
                    "        </div>\n" +
                    "    </div>\n" +
                    "</div>")

            },
            success: function (data) {
                content.html(data)
            },
            complete: function () {
            },
            error: function (jqXHR) {
                content.html(jqXHR.responseText);
            }
        })
    }

    function generatePdf() {
        //alert("logopdf");
        $('.logoPdf').css('display', 'block');
        doc.addHTML($('#monPdf')[0], 0, 0, {
            'background': '#fff',
        }, function () {
            // doc.save('situation_' + $('#indicator').text() + '.pdf');
            doc.save('situation_.pdf');
        });
        $('.logoPdf').css('display', 'none');

    }

    $(document).ready(function () {
        // on récupère les références des différents composants de la page
        doc = new jsPDF('p', 'pt', 'a4');

        $('#contrat').addClass("menutopActiv");
        content = $("#contenu");


        /*******   Bouton menu Contrat     ********************/

        $('.BtnCtrt').click(function () {

            var val = $(this).attr('id');
            console.log("val " + val);

            if ($('#blockCtrt' + val).is(":visible")) {
                console.log("visible");
                $('#blockCtrt' + val).hide();
            } else if ($('#blockCtrt' + val).is(":hidden")) {
                console.log("invisible");
                $('.sectionD').hide();
                $('#blockCtrt' + val).show();
                idContrat = val;
            }
        });


    });
</script>
<script th:inline="javascript">
    /*<![CDATA[*/

    var message = [[${message}]];
    //alert(message);
    var title = [[${title}]];
    var info = [[${info}]];

    var success = [[${success}]];

    if (message && title) {
        if (success === true) {
            if (info === true) {
                showInfo(title, message);
            } else {
                showSuccess(title, message);
            }
        } else if (success === false) {
            showError(title, message);
        }
    }

    /*]]>*/
</script>
</body>
</html>
